{% extends 'base.html' %}
{% load staticfiles comments crispy_forms_tags %}
{% block title %}Chapters{% endblock %}
{% comment %}For getting request data into angular app{% endcomment %}
{% block extra_body_tag_data %}
    ng-controller="ChapterGlobalCtrl"
    ng-init="initialize(
    '{{ user.is_authenticated }}',
    '{{ user.id }}',
    '{{ user.chapter_id }}',
    '{% if chapter %}{{ chapter.id }}{% endif %}',
    '{{ request.get_host }}'
    )"
{% endblock extra_body_tag_data %}

{% block content %}
    <div class="span9">

    <div ng-controller="ChapterListCtrl">

        <ul class="nav nav-tabs nav-stacked">
            <li ng-repeat="chapter in chapters">
                <table class="table table-bordered table-condensed">
                    <caption>
                        <h3 class="left-align">
                            <a href="{[{ chapter.absolute_url }]}">
                                {[{ chapter.fraternity_title }]}
                            </a>
                            <small>
                                {[{ chapter.title }]} chapter
                            </small>
                        </h3>
                    </caption>
                    <thead>
                    <tr>
                        <th class="span2">
                            Members:
                        </th>
                        <th class="span2">
                            Status:
                        </th>
                        <th class="span2">
                            GPA:
                        </th>
                        <th class="span2">
                            Cost:
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>
                            {[{ chapter.user_count }]}
                        </td>
                        <td>
                            {[{ chapter.status }]}
                        </td>
                        <td>
                            {[{ chapter.gpa }]}
                        </td>
                        <td>
                            $ {[{ chapter.cost }]}
                        </td>
                    </tr>
                    </tbody>
                </table>
            </li>
        </ul>


    </div>

    </div>
    {% endblock content %}

{% block left_content %}
<div class="span3">
<div ng-controller="ChapterListCtrl">
    <form class="form-search">
        <div class="controls">
            <input type="text" id="chapter-filter" name="chapter-filter" class="search-query input-medium"
                   placeholder="Search" ng-model="chapterFilter"
                   typeahead="chapter.fraternity_title for chapter in chapters | filter:$viewValue | limitTo:8"/>
        </div>
    </form>
    <ul class="nav nav-pills nav-stacked">
            <li ng-repeat="chapter in chapters | filter:chapterFilter | orderBy:'start'">
            <a ng-href="{[{ chapter.absolute_url }]}"
               data-popover="
                                {[{ chapter.university_title }]}
                                <br/>
                                {[{ chapter.fraternity_title }]}
                                "
               data-popover-title="{[{ chapter.fraternity_title }]}"
               data-popover-placement="right"
               data-popover-trigger="mouseenter"
               data-popover-popup-delay="500"
               ng-bind="chapter.fraternity_title">
            </a>
        </li>
    </ul>
</div>
</div>

{% endblock left_content %}



{% block angular_app_name %}chapterApp{% endblock angular_app_name %}


{% block angular_modules %}
    <script src="{% static 'angularjs/app/lib/angular/angular-cookies.js' %}"></script>
    <script src="{% static 'angularjs/app/lib/angular/angular-resource.js' %}"></script>
    <script src="{% static 'angularjs/app/lib/angular/angular-route.js' %}"></script>
    <script src="{% static 'angularjs/app/lib/angular/angular-animate.js' %}"></script>
{% endblock angular_modules %}
{% block angular_app %}
    <script src="{% static 'chapters/app/js/app.js' %}"></script>
    <script src="{% static 'chapters/app/js/controllers.js' %}"></script>
    <script src="{% static 'chapters/app/js/services.js' %}"></script>
    <script src="{% static 'chapters/app/js/directives.js' %}"></script>
    <script src="{% static 'chapters/app/js/filters.js' %}"></script>


{% endblock angular_app %}


